<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image to Base64 | Convert Images to Base64 Encoding | Tool-ify</title>
    <meta name="description" content="Convert images to Base64 string online for free. Easy-to-use tool for embedding images directly in CSS, HTML, or JSON files.">
    <meta name="keywords" content="image to base64, base64 image converter, base64 encoder, data url, image encoder, embed images, inline images">
    <link rel="canonical" href="https://tool-ify.com/tools/image-to-base64.html">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RDHJFH4L0J"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-RDHJFH4L0J');
    </script>
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Image to Base64",
        "url": "https://tool-ify.com/tools/image-to-base64.html",
        "description": "Convert images to Base64 encoding",
        "applicationCategory": "UtilityApplication",
        "offers": {
            "@type": "Offer",
            "price": "0"
        }
    }
    </script>
    <style>
        /* 修复布局，确保页面至少占满整个视口高度 */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        main {
            flex: 1 0 auto;
        }
        
        footer {
            flex-shrink: 0;
            margin-top: 20px;
        }
        
        .tool-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .file-drop-area {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 20px;
            transition: border-color 0.3s;
            background-color: var(--bg-secondary);
        }
        
        .file-drop-area.active {
            border-color: var(--accent-color);
        }
        
        .file-input {
            display: none;
        }
        
        .file-upload-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
        }
        
        .file-upload-btn:hover {
            background-color: var(--accent-hover);
        }
        
        .file-msg {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }
        
        .options {
            margin: 20px 0;
        }
        
        .option-group {
            margin-bottom: 15px;
        }
        
        .option-label {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .option-label input[type="radio"],
        .option-label input[type="checkbox"] {
            margin-right: 8px;
        }
        
        .preview-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }
        
        @media (min-width: 768px) {
            .preview-container {
                flex-direction: row;
            }
            
            .preview-image,
            .preview-html {
                flex: 1;
            }
        }
        
        .preview-image {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            background-color: var(--bg-secondary);
            text-align: center;
        }
        
        .preview-img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 4px;
        }
        
        .preview-html {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            background-color: var(--bg-secondary);
        }
        
        .preview-html pre {
            margin: 0;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 12px;
            overflow: auto;
            max-height: 200px;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .img-info {
            margin-top: 10px;
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        .code-section {
            margin: 20px 0;
        }
        
        .code-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .code-label h3 {
            margin: 0;
            font-size: 16px;
        }
        
        .code-actions {
            display: flex;
            gap: 10px;
        }
        
        .code-textarea {
            width: 100%;
            height: 150px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--bg-secondary);
            color: var(--text-color);
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 13px;
            resize: vertical;
            margin-bottom: 10px;
            white-space: pre;
            overflow-x: auto;
        }
        
        .code-info {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        button:hover {
            background-color: var(--accent-hover);
        }
        
        button.secondary {
            background-color: var(--bg-secondary);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        button.secondary:hover {
            background-color: var(--border-color);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .back-link:hover {
            color: var(--accent-color);
        }
        
        .back-link i {
            margin-right: 6px;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transform: translateY(100px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            z-index: 1000;
        }
        
        .notification.success {
            background-color: var(--accent-color);
            color: white;
        }
        
        .notification.error {
            background-color: #e53e3e;
            color: white;
        }
        
        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .usage-examples {
            margin-top: 30px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            background-color: var(--bg-secondary);
        }
        
        .usage-examples h3 {
            margin-top: 0;
            margin-bottom: 15px;
        }
        
        .example-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 15px;
        }
        
        .example-tab {
            padding: 8px 15px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-size: 14px;
            margin-right: 10px;
        }
        
        .example-tab.active {
            color: var(--accent-color);
            border-bottom: 2px solid var(--accent-color);
        }
        
        .example-content {
            display: none;
        }
        
        .example-content.active {
            display: block;
        }
        
        .example-code {
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 15px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 13px;
            overflow-x: auto;
            white-space: pre;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <a href="../index.html">Tool-ify</a>
            </div>
            <div class="header-actions">
                <div class="language-selector">
                    <button class="language-btn" id="language-toggle">
                        <i class="fas fa-globe"></i>
                        <span id="current-language">English</span>
                    </button>
                    <div class="language-dropdown" id="language-dropdown">
                        <a href="#" data-lang="en">English</a>
                        <a href="#" data-lang="zh">中文</a>
                        <a href="#" data-lang="es">Español</a>
                    </div>
                </div>
                <button class="theme-toggle" id="theme-toggle">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="tool-container">
                <a href="../index.html" class="back-link">
                    <i class="fas fa-arrow-left"></i> <span id="back-text">Back to tools</span>
                </a>
                
                <h1 id="tool-title">Image to Base64</h1>
                <p id="tool-description">Convert images to Base64 encoding for embedding in code</p>
                
                <div class="file-drop-area" id="drop-area">
                    <p class="file-msg" id="file-msg">Drag & drop an image here or</p>
                    <input type="file" id="file-input" class="file-input" accept="image/*">
                    <button class="file-upload-btn" id="file-upload-btn">
                        <i class="fas fa-upload"></i> <span id="choose-image-text">Choose Image</span>
                    </button>
                </div>
                
                <div class="options" id="options">
                    <h3 id="options-title">Output Options</h3>
                    <div class="option-group">
                        <label class="option-label">
                            <input type="radio" name="output-type" value="base64" checked> <span id="base64-string-only">Base64 String Only</span>
                        </label>
                        <label class="option-label">
                            <input type="radio" name="output-type" value="data-url"> <span id="data-url-text">Data URL (with mime type)</span>
                        </label>
                    </div>
                    <div class="option-group">
                        <label class="option-label">
                            <input type="checkbox" id="include-html" checked> <span id="include-html-text">Include HTML Code Example</span>
                        </label>
                        <label class="option-label">
                            <input type="checkbox" id="include-css" checked> <span id="include-css-text">Include CSS Code Example</span>
                        </label>
                    </div>
                </div>
                
                <div class="preview-container" id="preview-container" style="display: none;">
                    <div class="preview-image">
                        <h3 id="original-image-text">Original Image</h3>
                        <img id="preview-img" class="preview-img">
                        <div class="img-info" id="img-info"></div>
                    </div>
                    
                    <div class="preview-html">
                        <h3 id="html-preview-text">HTML Preview (Using Base64)</h3>
                        <div id="html-preview"></div>
                        <div class="img-info" id="img-info-text">The image above is embedded using the Base64 data.</div>
                    </div>
                </div>
                
                <div class="code-section" id="base64-output" style="display: none;">
                    <div class="code-label">
                        <h3 id="base64-output-text">Base64 Output</h3>
                        <div class="code-actions">
                            <button id="copy-base64" class="secondary">
                                <i class="fas fa-copy"></i> <span id="copy-text-1">Copy</span>
                            </button>
                        </div>
                    </div>
                    <textarea id="base64-textarea" class="code-textarea" readonly></textarea>
                    <div class="code-info">
                        <span id="base64-length">Length: 0 characters</span>
                        <span id="base64-size">Size: 0 KB</span>
                    </div>
                </div>
                
                <div class="code-section" id="html-example" style="display: none;">
                    <div class="code-label">
                        <h3 id="html-code-example-text">HTML Code Example</h3>
                        <div class="code-actions">
                            <button id="copy-html" class="secondary">
                                <i class="fas fa-copy"></i> <span id="copy-text-2">Copy</span>
                            </button>
                        </div>
                    </div>
                    <textarea id="html-textarea" class="code-textarea" readonly></textarea>
                </div>
                
                <div class="code-section" id="css-example" style="display: none;">
                    <div class="code-label">
                        <h3 id="css-code-example-text">CSS Code Example</h3>
                        <div class="code-actions">
                            <button id="copy-css" class="secondary">
                                <i class="fas fa-copy"></i> <span id="copy-text-3">Copy</span>
                            </button>
                        </div>
                    </div>
                    <textarea id="css-textarea" class="code-textarea" readonly></textarea>
                </div>
                
                <div class="button-group" id="action-buttons">
                    <button id="reset-btn" class="secondary">
                        <i class="fas fa-trash"></i> <span id="reset-btn-text">Reset</span>
                    </button>
                </div>
                
                <div class="usage-examples">
                    <h3 id="why-use-base64">Why Use Base64 Images?</h3>
                    <p id="base64-explanation">Base64 encoding allows you to embed images directly into HTML, CSS, or JavaScript files without requiring additional HTTP requests. This can be useful for:</p>
                    <ul>
                        <li id="use-case-1">Small icons and UI elements</li>
                        <li id="use-case-2">Reducing HTTP requests for better performance</li>
                        <li id="use-case-3">Embedding images in single-file applications</li>
                        <li id="use-case-4">Including images in JSON data</li>
                    </ul>
                    
                    <h3 id="usage-examples-title">Usage Examples</h3>
                    <div class="example-tabs">
                        <div class="example-tab active" data-tab="html-tab" id="html-tab-btn">HTML</div>
                        <div class="example-tab" data-tab="css-tab" id="css-tab-btn">CSS</div>
                        <div class="example-tab" data-tab="js-tab" id="js-tab-btn">JavaScript</div>
                    </div>
                    
                    <div class="example-content active" id="html-tab">
                        <pre class="example-code">&lt;img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA..." alt="Image description"&gt;</pre>
                    </div>
                    
                    <div class="example-content" id="css-tab">
                        <pre class="example-code">.element {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA...');
    background-repeat: no-repeat;
    background-position: center;
}</pre>
                    </div>
                    
                    <div class="example-content" id="js-tab">
                        <pre class="example-code">const img = new Image();
img.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA...';
document.body.appendChild(img);</pre>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <p>&copy; 2023 Tool-ify.com - All tools are free and work in your browser</p>
                </div>
                <div class="footer-links">
                    <a href="../contact.html">Contact</a>
                    <a href="../privacy.html">Privacy Policy</a>
                    <a href="../terms.html">Terms of Use</a>
                </div>
            </div>
        </div>
    </footer>
    
    <div class="notification" id="notification">Notification message</div>

    <script src="../js/main.js"></script>
    <script src="../js/localization.js"></script>
    <script src="../js/loading.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 等待翻译加载完成
            function applyTranslations() {
                if (window.translations) {
                    // 更新页面文本
                    updateTexts();
                    
                    // 更新动态文本，如通知消息
                    setupNotifications();
                } else {
                    // 如果翻译尚未加载，等待100毫秒后再次尝试
                    setTimeout(applyTranslations, 100);
                }
            }
            
            // 开始尝试应用翻译
            applyTranslations();
            
            // 更新页面文本
            function updateTexts() {
                if (window.translations) {
                    // 更新返回链接
                    if (window.translations.footer && window.translations.footer.back) {
                        const backText = document.getElementById('back-text');
                        if (backText) {
                            backText.textContent = window.translations.footer.back;
                        }
                    }
                    
                    // 更新UI文本
                    if (window.translations.ui) {
                        const textMappings = {
                            'file-msg': 'drag_drop',
                            'choose-image-text': 'choose_image',
                            'options-title': 'options',
                            'base64-string-only': 'base64_string_only',
                            'data-url-text': 'data_url_with_mime',
                            'include-html-text': 'include_html_example',
                            'include-css-text': 'include_css_example',
                            'original-image-text': 'original_image',
                            'html-preview-text': 'html_preview',
                            'img-info-text': 'embedded_image_info',
                            'base64-output-text': 'base64_output',
                            'html-code-example-text': 'html_code_example',
                            'css-code-example-text': 'css_code_example',
                            'copy-text-1': 'copy',
                            'copy-text-2': 'copy',
                            'copy-text-3': 'copy',
                            'reset-btn-text': 'reset',
                            'why-use-base64': 'why_use_base64',
                            'base64-explanation': 'base64_explanation',
                            'use-case-1': 'use_case_icons',
                            'use-case-2': 'use_case_http',
                            'use-case-3': 'use_case_single_file',
                            'use-case-4': 'use_case_json',
                            'usage-examples-title': 'usage_examples',
                            'html-tab-btn': 'html',
                            'css-tab-btn': 'css',
                            'js-tab-btn': 'javascript'
                        };
                        
                        for (const [id, key] of Object.entries(textMappings)) {
                            if (window.translations.ui[key]) {
                                const element = document.getElementById(id);
                                if (element) {
                                    element.textContent = window.translations.ui[key];
                                }
                            }
                        }
                    }
                }
            }
            
            // 设置通知消息翻译
            function setupNotifications() {
                // 保存原始的showNotification函数引用
                const originalShowNotification = showNotification;
                
                // 重新定义showNotification函数
                window.showNotification = function(message, type) {
                    // 尝试获取翻译
                    const translatedMessage = getTranslatedText(message, message);
                    // 调用原始函数，但使用翻译后的消息
                    originalShowNotification(translatedMessage, type);
                };
            }
            
            // 获取翻译文本
            function getTranslatedText(key, defaultText) {
                if (window.translations && window.translations.notifications) {
                    // 尝试找到完全匹配的键
                    if (window.translations.notifications[key]) {
                        return window.translations.notifications[key];
                    }
                    
                    // 如果没有完全匹配，尝试根据消息内容查找相似的键
                    if (key.includes('copy') || key === 'Copied to clipboard') {
                        return window.translations.notifications.copied_clipboard || defaultText;
                    }
                    
                    if (key.includes('valid image')) {
                        return window.translations.notifications.invalid_format || defaultText;
                    }
                    
                    if (key.includes('Nothing to copy')) {
                        return window.translations.notifications.nothing_to_copy || defaultText;
                    }
                }
                
                return defaultText;
            }

            // DOM Elements
            const dropArea = document.getElementById('drop-area');
            const fileInput = document.getElementById('file-input');
            const fileUploadBtn = document.querySelector('.file-upload-btn');
            const outputTypeRadios = document.getElementsByName('output-type');
            const includeHtmlCheckbox = document.getElementById('include-html');
            const includeCssCheckbox = document.getElementById('include-css');
            const previewContainer = document.getElementById('preview-container');
            const previewImg = document.getElementById('preview-img');
            const imgInfo = document.getElementById('img-info');
            const htmlPreview = document.getElementById('html-preview');
            const base64Output = document.getElementById('base64-output');
            const base64Textarea = document.getElementById('base64-textarea');
            const base64Length = document.getElementById('base64-length');
            const base64Size = document.getElementById('base64-size');
            const htmlExample = document.getElementById('html-example');
            const htmlTextarea = document.getElementById('html-textarea');
            const cssExample = document.getElementById('css-example');
            const cssTextarea = document.getElementById('css-textarea');
            const copyBase64Btn = document.getElementById('copy-base64');
            const copyHtmlBtn = document.getElementById('copy-html');
            const copyCssBtn = document.getElementById('copy-css');
            const resetBtn = document.getElementById('reset-btn');
            const notification = document.getElementById('notification');
            const exampleTabs = document.querySelectorAll('.example-tab');
            const exampleContents = document.querySelectorAll('.example-content');
            
            // State variables
            let originalImage = null;
            let base64String = '';
            let dataUrl = '';
            
            // Example tabs
            exampleTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs and contents
                    exampleTabs.forEach(t => t.classList.remove('active'));
                    exampleContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to selected tab and content
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Click to upload
            fileUploadBtn.addEventListener('click', function() {
                fileInput.click();
            });
            
            // Handle file input change
            fileInput.addEventListener('change', function(e) {
                handleFiles(e.target.files);
            });
            
            // Handle drag and drop
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                dropArea.classList.add('active');
            }
            
            function unhighlight() {
                dropArea.classList.remove('active');
            }
            
            dropArea.addEventListener('drop', function(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            });
            
            // Handle uploaded files
            function handleFiles(files) {
                if (files.length > 0) {
                    const file = files[0];
                    
                    // Check if file is an image
                    if (!file.type.match('image.*')) {
                        showNotification('Please select a valid image file', 'error');
                        return;
                    }
                    
                    // Store original image
                    originalImage = file;
                    
                    // Display file info
                    imgInfo.textContent = `${file.name} (${formatFileSize(file.size)})`;
                    
                    // 显示加载中遮罩 - 大文件处理可能需要时间
                    if (file.size > 1024 * 1024) { // 如果文件大于1MB
                        Loading.show();
                    }
                    
                    // Convert to Base64
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        dataUrl = e.target.result;
                        base64String = dataUrl.split(',')[1];
                        
                        // Preview the image
                        previewImg.src = dataUrl;
                        htmlPreview.innerHTML = `<img src="${dataUrl}" style="max-width: 100%; max-height: 150px; border-radius: 4px;">`;
                        
                        // Show preview container
                        previewContainer.style.display = 'flex';
                        
                        // Update output based on selected options
                        updateOutput();
                        
                        // 隐藏加载中遮罩
                        Loading.hide();
                    };
                    
                    reader.onerror = function() {
                        showNotification('Error reading file', 'error');
                        Loading.hide();
                    };
                    
                    reader.readAsDataURL(file);
                }
            }
            
            // Update output when options change
            outputTypeRadios.forEach(radio => {
                radio.addEventListener('change', updateOutput);
            });
            
            includeHtmlCheckbox.addEventListener('change', function() {
                htmlExample.style.display = this.checked ? 'block' : 'none';
            });
            
            includeCssCheckbox.addEventListener('change', function() {
                cssExample.style.display = this.checked ? 'block' : 'none';
            });
            
            // Update output based on selected options
            function updateOutput() {
                if (!base64String) return;
                
                const outputType = getSelectedRadioValue(outputTypeRadios);
                const outputText = outputType === 'base64' ? base64String : dataUrl;
                
                // 如果数据量较大，显示加载中遮罩
                const isLargeData = outputText.length > 500000; // 约500KB
                if (isLargeData) {
                    Loading.show();
                    
                    // 使用setTimeout将操作推迟到下一个事件循环，让浏览器有机会显示loading
                    setTimeout(() => {
                        updateOutputContent(outputText);
                        Loading.hide();
                    }, 50);
                } else {
                    // 数据量不大，直接处理
                    updateOutputContent(outputText);
                }
            }
            
            // 实际更新输出内容的函数
            function updateOutputContent(outputText) {
                // Update Base64 output
                base64Textarea.value = outputText;
                base64Length.textContent = `Length: ${outputText.length.toLocaleString()} characters`;
                base64Size.textContent = `Size: ${formatFileSize(outputText.length * 0.75)}`; // Base64 is ~3/4 of byte size
                
                // Show Base64 output
                base64Output.style.display = 'block';
                
                // Update HTML example
                if (includeHtmlCheckbox.checked) {
                    htmlTextarea.value = `<img src="${dataUrl}" alt="Image">`;
                    htmlExample.style.display = 'block';
                } else {
                    htmlExample.style.display = 'none';
                }
                
                // Update CSS example
                if (includeCssCheckbox.checked) {
                    cssTextarea.value = `.element {\n    background-image: url('${dataUrl}');\n    background-repeat: no-repeat;\n    background-position: center;\n}`;
                    cssExample.style.display = 'block';
                } else {
                    cssExample.style.display = 'none';
                }
            }
            
            // Copy buttons
            copyBase64Btn.addEventListener('click', function() {
                copyToClipboard(base64Textarea);
            });
            
            copyHtmlBtn.addEventListener('click', function() {
                copyToClipboard(htmlTextarea);
            });
            
            copyCssBtn.addEventListener('click', function() {
                copyToClipboard(cssTextarea);
            });
            
            // Reset everything
            resetBtn.addEventListener('click', function() {
                fileInput.value = '';
                originalImage = null;
                base64String = '';
                dataUrl = '';
                
                previewImg.src = '';
                htmlPreview.innerHTML = '';
                imgInfo.textContent = '';
                
                base64Textarea.value = '';
                htmlTextarea.value = '';
                cssTextarea.value = '';
                
                previewContainer.style.display = 'none';
                base64Output.style.display = 'none';
                htmlExample.style.display = 'none';
                cssExample.style.display = 'none';
                
                outputTypeRadios[0].checked = true;
                includeHtmlCheckbox.checked = true;
                includeCssCheckbox.checked = true;
            });
            
            // Helper function to get selected radio value
            function getSelectedRadioValue(radioButtons) {
                for (const radioButton of radioButtons) {
                    if (radioButton.checked) {
                        return radioButton.value;
                    }
                }
                return null;
            }
            
            // Helper function to copy to clipboard
            function copyToClipboard(element) {
                if (!element.value) {
                    showNotification('Nothing to copy', 'error');
                    return;
                }
                
                // 大文本复制可能会导致UI卡顿
                const isLargeText = element.value.length > 100000; // 约100KB
                
                if (isLargeText) {
                    Loading.show();
                    
                    // 使用setTimeout将操作推迟到下一个事件循环
                    setTimeout(() => {
                        element.select();
                        document.execCommand('copy');
                        Loading.hide();
                        showNotification('Copied to clipboard', 'success');
                    }, 50);
                } else {
                    element.select();
                    document.execCommand('copy');
                    showNotification('Copied to clipboard', 'success');
                }
            }
            
            // Helper function to format file size
            function formatFileSize(bytes) {
                if (bytes < 1024) {
                    return bytes + ' B';
                } else if (bytes < 1024 * 1024) {
                    return (bytes / 1024).toFixed(2) + ' KB';
                } else {
                    return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
                }
            }

            // Show notification
            function showNotification(message, type) {
                notification.textContent = message;
                notification.className = 'notification ' + type;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        });
    </script>
</body>
</html> 